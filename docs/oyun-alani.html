<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <!-- Theme initialization (prevent flash) -->
    <script>
        (function() {
            var savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
            }
        })();
    </script>
    <title>Oyun AlanÄ± - p5.js Kursu</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/tomorrow-night-eighties.min.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        .playground-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        .playground-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .playground-header h1 {
            margin-bottom: 0.5rem;
        }
        
        .playground-header p {
            color: var(--text-muted);
        }
        
        .playground-main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 1024px) {
            .playground-main {
                grid-template-columns: 1fr;
            }
        }
        
        .editor-section {
            background: var(--bg-light);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        .editor-toolbar {
            display: flex;
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--bg-dark);
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
        }
        
        .editor-toolbar button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .btn-run {
            background: var(--accent-secondary);
            color: var(--bg-dark);
        }
        
        .btn-run:hover {
            background: #00cc44;
        }
        
        .btn-stop {
            background: var(--accent-danger);
            color: white;
        }
        
        .btn-reset {
            background: var(--bg-light);
            color: var(--text-light);
            border: 1px solid var(--border-color) !important;
        }
        
        .btn-copy {
            background: var(--accent-primary);
            color: var(--bg-dark);
        }
        
        .btn-download {
            background: var(--accent-warning);
            color: var(--bg-dark);
            margin-left: auto;
        }
        
        .code-area {
            height: 500px;
        }
        
        .code-area .CodeMirror {
            height: 100%;
            font-size: 14px;
        }
        
        .preview-section {
            background: var(--bg-light);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        .preview-header {
            padding: 0.75rem 1rem;
            background: var(--bg-dark);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .preview-header h3 {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        
        .preview-frame {
            width: 100%;
            height: 400px;
            border: none;
            background: white;
        }
        
        .console-area {
            background: #1a1a2e;
            border-top: 1px solid var(--border-color);
            height: 100px;
            overflow-y: auto;
            padding: 0.5rem;
            font-family: 'Fira Code', monospace;
            font-size: 12px;
        }
        
        .console-line {
            padding: 0.25rem 0;
            color: #ccc;
        }
        
        .console-line.error {
            color: #ff6b6b;
        }
        
        .console-line.log {
            color: #4ecdc4;
        }
        
        .templates-section {
            margin-top: 2rem;
        }
        
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .template-card {
            background: var(--bg-light);
            border-radius: 10px;
            padding: 1rem;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .template-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-3px);
        }
        
        .template-card h4 {
            margin: 0 0 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .template-card p {
            margin: 0;
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        .fullscreen-btn {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-muted);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .fullscreen-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav">
        <div class="container">
            <div class="nav-content">
                <a href="index.html" class="nav-brand">
                    <span>ğŸ¨</span>
                    <span>Ä°nteraktif p5.js EÄŸitimi</span>
                </a>
                <ul class="nav-links">
                    <li><a href="index.html">Ana Sayfa</a></li>
                    <li><a href="lessons/01-giris.html">Dersler</a></li>
                    <li><a href="kaynaklar.html">Kaynaklar</a></li>
                    <li><a href="oyun-alani.html" class="active">Oyun AlanÄ±</a></li>
                </ul>
                <button class="theme-toggle" id="themeToggle" title="Tema DeÄŸiÅŸtir">ğŸŒ™</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="playground-container">
        <div class="playground-header">
            <h1>ğŸ® Oyun AlanÄ±</h1>
            <p>Ã–ÄŸrendiklerini dene! Kendi projelerini oluÅŸtur, deney yap, eÄŸlen!</p>
        </div>
        
        <div class="playground-main">
            <!-- Editor -->
            <div class="editor-section">
                <div class="editor-toolbar">
                    <button class="btn-run" onclick="runCode()">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                    <button class="btn-stop" onclick="stopCode()">â¹ Durdur</button>
                    <button class="btn-reset" onclick="resetCode()">â†º SÄ±fÄ±rla</button>
                    <button class="btn-copy" onclick="copyCode()">ğŸ“‹ Kopyala</button>
                    <button class="btn-download" onclick="downloadCode()">ğŸ’¾ Ä°ndir</button>
                </div>
                <div id="code-editor" class="code-area"></div>
            </div>
            
            <!-- Preview -->
            <div class="preview-section">
                <div class="preview-header">
                    <h3>ğŸ“º Ã–nizleme</h3>
                    <button class="fullscreen-btn" onclick="toggleFullscreen()">â›¶ Tam Ekran</button>
                </div>
                <iframe id="preview-frame" class="preview-frame"></iframe>
                <div id="console-output" class="console-area">
                    <div class="console-line" style="color: #888;">// Konsol Ã§Ä±ktÄ±sÄ± burada gÃ¶rÃ¼necek</div>
                </div>
            </div>
        </div>
        
        <!-- Templates -->
        <div class="templates-section">
            <h2>ğŸ“ HazÄ±r Åablonlar</h2>
            <p style="color: var(--text-muted);">Bir ÅŸablona tÄ±klayarak hÄ±zlÄ±ca baÅŸla:</p>
            
            <div class="templates-grid">
                <div class="template-card" onclick="loadTemplate('blank')">
                    <h4>ğŸ“„ BoÅŸ Tuval</h4>
                    <p>SÄ±fÄ±rdan baÅŸla</p>
                </div>
                
                <div class="template-card" onclick="loadTemplate('animation')">
                    <h4>ğŸ”„ Animasyon</h4>
                    <p>Basit hareket Ã¶rneÄŸi</p>
                </div>
                
                <div class="template-card" onclick="loadTemplate('interactive')">
                    <h4>ğŸ–±ï¸ EtkileÅŸim</h4>
                    <p>Fare takibi Ã¶rneÄŸi</p>
                </div>
                
                <div class="template-card" onclick="loadTemplate('particles')">
                    <h4>âœ¨ ParÃ§acÄ±klar</h4>
                    <p>ParÃ§acÄ±k sistemi</p>
                </div>
                
                <div class="template-card" onclick="loadTemplate('game')">
                    <h4>ğŸ® Mini Oyun</h4>
                    <p>Basit oyun ÅŸablonu</p>
                </div>
                
                <div class="template-card" onclick="loadTemplate('art')">
                    <h4>ğŸ¨ Generatif Sanat</h4>
                    <p>Rastgele sanat Ã¶rneÄŸi</p>
                </div>
            </div>
        </div>
        
        <!-- Tips -->
        <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(0, 217, 255, 0.05); border-radius: 12px; border: 1px solid rgba(0, 217, 255, 0.2);">
            <h3 style="margin-top: 0;">ğŸ’¡ Ä°puÃ§larÄ±</h3>
            <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
                <li><strong>Ctrl+Enter</strong> ile kodu Ã§alÄ±ÅŸtÄ±r</li>
                <li>Hata aldÄ±ÄŸÄ±nda konsola bak</li>
                <li>Kodu deÄŸiÅŸtirdikten sonra tekrar "Ã‡alÄ±ÅŸtÄ±r" butonuna tÄ±kla</li>
                <li>Projeyi kaydetmek iÃ§in "Ä°ndir" butonunu kullan</li>
                <li>Daha fazla Ã¶rnek iÃ§in <a href="lessons/01-giris.html">derslere</a> gÃ¶z at</li>
            </ul>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer" style="margin-top: 3rem;">
        <div class="container">
            <div class="footer-bottom">
                <p>Ä°nteraktif p5.js EÄŸitimi | GÃ¼venÃ§ Usanmaz | <a href="https://github.com/gusanmaz/p5js-course" target="_blank">GitHub</a></p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
    
    <script>
        // Templates
        const templates = {
            blank: `function setup() {
  createCanvas(400, 400);
  background(30);
}

function draw() {
  // Kodunuzu buraya yazÄ±n
  
}`,
            
            animation: `let x = 0;
let y = 200;
let hiz = 3;

function setup() {
  createCanvas(400, 400);
}

function draw() {
  background(30, 30, 50);
  
  // Topu hareket ettir
  x += hiz;
  
  // Kenardan sekme
  if (x > width - 25 || x < 25) {
    hiz *= -1;
  }
  
  // Topu Ã§iz
  fill(100, 200, 255);
  noStroke();
  circle(x, y, 50);
  
  // ParlaklÄ±k efekti
  fill(255, 255, 255, 100);
  circle(x - 10, y - 10, 15);
}`,
            
            interactive: `function setup() {
  createCanvas(400, 400);
  noCursor();
}

function draw() {
  background(30, 30, 50, 20);
  
  // Fare takip eden daireler
  let boyut = 50 + sin(frameCount * 0.1) * 20;
  
  // GÃ¶lge
  fill(0, 50);
  noStroke();
  circle(mouseX + 5, mouseY + 5, boyut);
  
  // Ana daire
  let renk = color(
    sin(frameCount * 0.02) * 127 + 128,
    sin(frameCount * 0.03) * 127 + 128,
    sin(frameCount * 0.04) * 127 + 128
  );
  fill(renk);
  circle(mouseX, mouseY, boyut);
  
  // Ä°Ã§ daire
  fill(255, 100);
  circle(mouseX, mouseY, boyut * 0.5);
}`,
            
            particles: `let parcaciklar = [];

function setup() {
  createCanvas(400, 400);
}

function draw() {
  background(20, 20, 40, 50);
  
  // Yeni parÃ§acÄ±k ekle
  if (mouseIsPressed) {
    for (let i = 0; i < 3; i++) {
      parcaciklar.push({
        x: mouseX,
        y: mouseY,
        vx: random(-3, 3),
        vy: random(-5, -1),
        boyut: random(5, 15),
        alfa: 255,
        renk: color(random(255), random(255), random(255))
      });
    }
  }
  
  // ParÃ§acÄ±klarÄ± gÃ¼ncelle ve Ã§iz
  for (let i = parcaciklar.length - 1; i >= 0; i--) {
    let p = parcaciklar[i];
    
    p.x += p.vx;
    p.y += p.vy;
    p.vy += 0.1;
    p.alfa -= 3;
    
    noStroke();
    fill(red(p.renk), green(p.renk), blue(p.renk), p.alfa);
    circle(p.x, p.y, p.boyut);
    
    if (p.alfa <= 0) {
      parcaciklar.splice(i, 1);
    }
  }
  
  // Bilgi
  fill(255);
  textSize(12);
  text("Fareyi basÄ±lÄ± tut!", 10, 25);
  text("ParÃ§acÄ±k: " + parcaciklar.length, 10, 45);
}`,
            
            game: `let oyuncuX = 200;
let puan = 0;
let hedefler = [];

function setup() {
  createCanvas(400, 400);
  
  // Hedefler oluÅŸtur
  for (let i = 0; i < 5; i++) {
    hedefEkle();
  }
}

function draw() {
  background(40, 40, 60);
  
  // YÄ±ldÄ±zlar
  randomSeed(99);
  for (let i = 0; i < 30; i++) {
    fill(255, random(100, 200));
    noStroke();
    circle(random(width), random(height), random(1, 3));
  }
  randomSeed(frameCount);
  
  // Oyuncu hareketi
  if (keyIsDown(LEFT_ARROW)) oyuncuX -= 5;
  if (keyIsDown(RIGHT_ARROW)) oyuncuX += 5;
  oyuncuX = constrain(oyuncuX, 20, width - 20);
  
  // Oyuncu Ã§iz
  fill(100, 200, 255);
  noStroke();
  triangle(oyuncuX, height - 50, oyuncuX - 15, height - 25, oyuncuX + 15, height - 25);
  
  // Hedefler
  for (let i = hedefler.length - 1; i >= 0; i--) {
    let h = hedefler[i];
    h.y += h.hiz;
    
    fill(255, 200, 50);
    circle(h.x, h.y, 20);
    
    // Toplama kontrolÃ¼
    if (dist(oyuncuX, height - 40, h.x, h.y) < 25) {
      puan += 10;
      hedefler.splice(i, 1);
      hedefEkle();
      continue;
    }
    
    // Ekran dÄ±ÅŸÄ±
    if (h.y > height + 20) {
      hedefler.splice(i, 1);
      hedefEkle();
    }
  }
  
  // Puan
  fill(255);
  textSize(20);
  text("Puan: " + puan, 10, 30);
}

function hedefEkle() {
  hedefler.push({
    x: random(30, width - 30),
    y: random(-100, -20),
    hiz: random(2, 4)
  });
}`,
            
            art: `function setup() {
  createCanvas(400, 400);
  noLoop();
}

function draw() {
  background(20);
  
  // Rastgele ÅŸekiller
  for (let i = 0; i < 50; i++) {
    let x = random(width);
    let y = random(height);
    let boyut = random(20, 100);
    
    // Rastgele renk
    fill(random(255), random(255), random(255), random(100, 200));
    noStroke();
    
    // Rastgele ÅŸekil
    let sekil = floor(random(3));
    
    if (sekil == 0) {
      circle(x, y, boyut);
    } else if (sekil == 1) {
      rectMode(CENTER);
      rect(x, y, boyut, boyut, random(10));
    } else {
      triangle(
        x, y - boyut/2,
        x - boyut/2, y + boyut/2,
        x + boyut/2, y + boyut/2
      );
    }
  }
  
  // Ã‡izgiler
  stroke(255, 30);
  strokeWeight(1);
  for (let i = 0; i < 20; i++) {
    line(random(width), random(height), random(width), random(height));
  }
}

function mousePressed() {
  redraw();  // TÄ±klayÄ±nca yeni sanat
}`
        };
        
        let editor;
        let originalCode = templates.blank;
        
        // Initialize CodeMirror
        document.addEventListener('DOMContentLoaded', function() {
            editor = CodeMirror(document.getElementById('code-editor'), {
                value: originalCode,
                mode: 'javascript',
                theme: 'tomorrow-night-eighties',
                lineNumbers: true,
                matchBrackets: true,
                autoCloseBrackets: true,
                indentUnit: 2,
                tabSize: 2,
                lineWrapping: true
            });
            
            // Ctrl+Enter to run
            editor.setOption('extraKeys', {
                'Ctrl-Enter': runCode
            });
            
            // Auto-run on load
            setTimeout(runCode, 500);
        });
        
        // Run code
        function runCode() {
            const code = editor.getValue();
            const frame = document.getElementById('preview-frame');
            const consoleOutput = document.getElementById('console-output');
            
            consoleOutput.innerHTML = '<div class="console-line" style="color: #888;">// Ã‡alÄ±ÅŸtÄ±rÄ±lÄ±yor...</div>';
            
            const html = `
<!DOCTYPE html>
<html>
<head>
    <style>
        body { margin: 0; overflow: hidden; display: flex; justify-content: center; align-items: center; min-height: 100vh; background: #1a1a2e; }
        canvas { display: block; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"><\/script>
</head>
<body>
    <script>
        // Console override
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            parent.postMessage({ type: 'log', message: args.map(a => String(a)).join(' ') }, '*');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            parent.postMessage({ type: 'error', message: args.map(a => String(a)).join(' ') }, '*');
        };
        
        window.onerror = function(msg, url, line) {
            parent.postMessage({ type: 'error', message: 'SatÄ±r ' + line + ': ' + msg }, '*');
        };
        
        try {
            ${code}
        } catch (e) {
            console.error(e.message);
        }
    <\/script>
</body>
</html>`;
            
            frame.srcdoc = html;
        }
        
        // Stop code
        function stopCode() {
            const frame = document.getElementById('preview-frame');
            frame.srcdoc = '<html><body style="background:#1a1a2e;display:flex;justify-content:center;align-items:center;height:100vh;color:#888;font-family:sans-serif;">Durduruldu</body></html>';
        }
        
        // Reset code
        function resetCode() {
            editor.setValue(originalCode);
            runCode();
        }
        
        // Copy code
        function copyCode() {
            navigator.clipboard.writeText(editor.getValue());
            alert('Kod kopyalandÄ±! ğŸ“‹');
        }
        
        // Download code
        function downloadCode() {
            const code = editor.getValue();
            const html = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>p5.js Projem</title>
    <style>
        body { margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; background: #1a1a2e; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"><\/script>
</head>
<body>
    <script>
${code}
    <\/script>
</body>
</html>`;
            
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'p5-projem.html';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Load template
        function loadTemplate(name) {
            if (templates[name]) {
                editor.setValue(templates[name]);
                originalCode = templates[name];
                runCode();
            }
        }
        
        // Toggle fullscreen
        function toggleFullscreen() {
            const frame = document.getElementById('preview-frame');
            if (frame.requestFullscreen) {
                frame.requestFullscreen();
            }
        }
        
        // Listen for console messages
        window.addEventListener('message', function(e) {
            if (e.data.type === 'log' || e.data.type === 'error') {
                const consoleOutput = document.getElementById('console-output');
                const line = document.createElement('div');
                line.className = 'console-line ' + e.data.type;
                line.textContent = (e.data.type === 'error' ? 'âŒ ' : 'ğŸ“ ') + e.data.message;
                consoleOutput.appendChild(line);
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            }
        });
    </script>
    <script src="js/theme.js"></script>
</body>
</html>
